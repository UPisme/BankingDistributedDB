CREATE DATABASE QLNGANHANG
GO

USE QLNGANHANG
GO

-- TAO BANG --
CREATE TABLE CHINHANH (
	MACN VARCHAR(10) NOT NULL,
	TENCN NVARCHAR(50) NOT NULL,
	DIACHI NVARCHAR(100) NOT NULL,
	SDT VARCHAR(10)
);

CREATE TABLE NHANVIEN (
	MANV VARCHAR(10) NOT NULL,
	HO NVARCHAR(40) NOT NULL,
	TEN NVARCHAR(10) NOT NULL,
	NGSINH DATE NOT NULL,
	CCCD VARCHAR(12) UNIQUE NOT NULL,
	SDT VARCHAR(10) NOT NULL,
	MACN VARCHAR(10) NOT NULL
);

CREATE TABLE KHACHHANG (
	MAKH VARCHAR(10) NOT NULL,
	HO NVARCHAR(40) NOT NULL,
	TEN NVARCHAR(10) NOT NULL,
	NGSINH DATE NOT NULL,
	PHAI INT NOT NULL,
	CCCD VARCHAR(12) UNIQUE NOT NULL,
	SDT VARCHAR(10) NOT NULL,
	DIACHI NVARCHAR(100),
	MACN VARCHAR(10) NOT NULL
);

CREATE TABLE TKNH (
	SOTK VARCHAR(10) NOT NULL,
	TENTK VARCHAR(50) NOT NULL,
	MATKHAU VARCHAR(20) NOT NULL,
	NGAYTAO DATETIME NOT NULL,
	SODU MONEY NOT NULL,
	TRANGTHAI INT NOT NULL,
	MAKH VARCHAR(10) NOT NULL,
	MACN VARCHAR(10) NOT NULL
);

CREATE TABLE GD_CHUYENNHAN (
	MAGD VARCHAR(10) NOT NULL,
	SOTK_GUI VARCHAR(10) NOT NULL,
	SOTK_NHAN VARCHAR(10) NOT NULL,
	SOTIEN MONEY NOT NULL,
	NGAYGD DATETIME NOT NULL,
	MANV VARCHAR(10) NOT NULL
);

CREATE TABLE GD_GOIRUT (
	MAGD VARCHAR(10) NOT NULL,
	SOTK VARCHAR(10) NOT NULL,
	LOAIGD VARCHAR(10) NOT NULL,
	SOTIEN MONEY NOT NULL,
	NGAYGD DATETIME NOT NULL,
	MANV VARCHAR(10) NOT NULL
);


-- TAO KHOA CHINH --
ALTER TABLE CHINHANH ADD CONSTRAINT PK_CHINHANH PRIMARY KEY (MACN)

ALTER TABLE NHANVIEN ADD CONSTRAINT PK_NHANVIEN PRIMARY KEY (MANV)

ALTER TABLE KHACHHANG ADD CONSTRAINT PK_KHACHHANG PRIMARY KEY (MAKH)

ALTER TABLE TKNH ADD CONSTRAINT PK_TKNH PRIMARY KEY (SOTK)

ALTER TABLE GD_CHUYENNHAN ADD CONSTRAINT PK_CHUYENNHAN PRIMARY KEY (MAGD)

ALTER TABLE GD_GOIRUT ADD CONSTRAINT PK_GOIRUT PRIMARY KEY (MAGD)


-- TAO KHOA NGOAI --
ALTER TABLE NHANVIEN ADD CONSTRAINT FK_NHANVIEN FOREIGN KEY (MACN) REFERENCES CHINHANH (MACN)

ALTER TABLE KHACHHANG ADD CONSTRAINT FK_KHACHHANG FOREIGN KEY (MACN) REFERENCES CHINHANH (MACN)

--ALTER TABLE TKNH ADD CONSTRAINT FK_TKNH FOREIGN KEY (MAKH) REFERENCES KHACHHANG (MAKH)

ALTER TABLE GD_CHUYENNHAN ADD CONSTRAINT FK_SOTKGUI FOREIGN KEY (SOTK_GUI) REFERENCES TKNH (SOTK)

ALTER TABLE GD_CHUYENNHAN ADD CONSTRAINT FK_SOTKNHAN FOREIGN KEY (SOTK_NHAN) REFERENCES TKNH (SOTK)

ALTER TABLE GD_CHUYENNHAN ADD CONSTRAINT FK_CHUYENNHAN_MANV FOREIGN KEY (MANV) REFERENCES NHANVIEN (MANV)

ALTER TABLE GD_GOIRUT ADD CONSTRAINT FK_SOTK FOREIGN KEY (SOTK) REFERENCES TKNH (SOTK)

ALTER TABLE GD_GOIRUT ADD CONSTRAINT FK_GOIRUT_MANV FOREIGN KEY (MANV) REFERENCES NHANVIEN (MANV)


-- NHAP DU LIEU --
-- BANG CHINHANH --
INSERT INTO CHINHANH (MACN, TENCN, DIACHI, SDT) VALUES ('CN01', N'ABC Hồ Chí Minh', N'198 Điện Biên Phủ, Phường 15, Quận Bình Thạnh, Thành phố Hồ Chí Minh', '0283825151')
INSERT INTO CHINHANH (MACN, TENCN, DIACHI, SDT) VALUES ('CN02', N'ABC Hà Nội', N'198 Trần Quang Khải, Phường Tràng Tiền, Quận Hoàn Kiếm, Thành phố Hà Nội', '0243934383')


-- BANG NHANVIEN --
INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV001', N'NGUYỄN VĂN', N'THANH', '2000-10-10', '087084000999', '0912841212', 'CN01')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV002', N'TRẦN THỊ', N'LAN', '1995-05-15', '093275811444', '0987654321', 'CN01')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV003', N'LÊ THỊ', N'HƯƠNG', '1992-08-03', '065432123457', '0978123456', 'CN01')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV004', N'HOÀNG VĂN', N'PHÚC', '1985-11-20', '077788899910', '0965432198', 'CN01')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV005', N'VŨ VĂN', N'AN', '1990-09-18', '099988878766', '0976543210', 'CN01')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV006', N'PHẠM THỊ', N'DIỄM', '1983-07-25', '088899900012', '0932145678', 'CN01')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV007', N'HOÀNG THỊ', N'HÀ', '1991-01-30', '056789012345', '0909123456', 'CN02')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV008', N'TRẦN VĂN', N'TUẤN', '1987-11-12', '066688899900', '0976543210', 'CN02')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV009', N'NGUYỄN VĂN', N'TÀI', '1980-09-07', '033377765653', '0918234567', 'CN02')

INSERT INTO NHANVIEN (MANV, HO, TEN, NGSINH, CCCD, SDT, MACN)
VALUES ('NV010', N'PHẠM THỊ', N'NHUNG', '1996-02-16', '099988876768', '0987654321', 'CN02')


-- BANG KHACHHANG --
INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0001', N'NGUYỄN VĂN', N'ANH', '1986-01-27', 0, '079123456789', '0123456789', N'14 Đường 16, Phường 11, Quận 6, Thành Phố Hồ Chí Minh', 'CN01')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0002',N'TRẦN NGỌC', N'LINH', '2000-03-20', 1, '079234567891', '0234567891', N'125 Đường 3/2, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN02')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0003', N'LÊ NHẬT', N'MINH', '1980-04-19', 0, '079345678912', '0345678912', N'111 Hồng Bàng, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN02')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0004', N'TRƯƠNG MỸ', N'HẠNH', '2004-01-19', 1, '079567891234', '0567891234', N'118 Hồng Bàng, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN02')
	
INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0005', N'NGUYỄN THỊ THANH', N'TRÚC', '2005-02-20', 1, '079678912345', '0678912345', N'11 Tân Hòa Đông, Phường An Lạc A, Quận Bình Tân, Thành Phố Hồ Chí Minh', 'CN02')
	
INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0006', N'PHẠM THANH', N'TRIỀU', '1989-02-19', 0, '079789123456', '0789123456', N'11 Vĩnh Viễn, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN01')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0007', N'NGUYỄN NHẬT', N'SƠN', '2002-02-25', 0, '078123456789', '0924681235', N'113 Hồng Bàng, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN01')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0008', N'TRẦN TRUNG', N'NGHĨA', '1999-06-28', 0, '078234567891', '0946822351', N'112 Hồng Bàng, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN01')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0009', N'TRẦN THỊ HỒNG', N'THẮM', '2002-04-27', 1, '078456789123', '0982465123', N'15 Hồng Bàng, P10, Tây Ninh', 'CN01')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0010', N'NGUYỄN THỊ KIM', N'YẾN', '1999-07-06', 1, '078678912345', '0983571246', N'105 Hồng Bàng, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN02')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0011', N'NGUYỄN VĂN', N'B', '1996-01-26', 0, '078789123456', '0985713246', N'1120 Nguyễn Trãi, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN02')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0012', N'TRẦN KIM', N'LINH', '2001-03-01', 1, '078891234567', '0987135246', N'1111 Nguyễn Trãi, Phường 10, Quận 5, Thành Phố Hồ Chí Minh', 'CN01')

INSERT INTO KHACHHANG (MAKH, HO, TEN, NGSINH, PHAI, CCCD, SDT, DIACHI, MACN)
VALUES ('KH0013', N'NGUYỄN QUỐC', N'MINH', '1998-07-09', 0, '078912345678', '0981357462', N'1110 Nguyễn Biểu, Phường 10, Quận Thanh Xuân, Thành Phố Hà Nội', 'CN02')

-- BANG TKNH --
INSERT INTO TKNH VALUES ('0123456789', 'NGUYEN VAN ANH', 'a1234', '2024-02-28', 8000000, 1, 'KH0001', 'CN01')
INSERT INTO TKNH VALUES ('0234567891', 'TRAN NGOC LINH', 'a2345', '2024-02-28', 0, 1, 'KH0002', 'CN02')
INSERT INTO TKNH VALUES ('0345678912', 'LE NHAT MINH', 'a3456', '2024-02-28', 0, 1, 'KH0003', 'CN02')
INSERT INTO TKNH VALUES ('0567891234', 'TRUONG MY HANH', 'a4567', '2024-01-15', 2350000, 1, 'KH0004', 'CN02')
INSERT INTO TKNH VALUES ('0678912345', 'NGUYEN THI THANH TRUC', 'a5678', '2024-01-15', 1008000, 1, 'KH0005', 'CN02')
INSERT INTO TKNH VALUES ('0789123456', 'PHAM THANH TRIEU', 'a6789', '2024-01-15', 1000000, 1, 'KH0006', 'CN01')
INSERT INTO TKNH VALUES ('0924681235', 'NGUYEN NHAT SON', 'a7891', '2024-01-15', 0, 1, 'KH0007', 'CN01')
INSERT INTO TKNH VALUES ('0946822351', 'TRAN TRUNG NGHIA', 'a8912', '2024-02-28', 0, 1, 'KH0008', 'CN01')
INSERT INTO TKNH VALUES ('0982465123', 'TRAN THI HONG THAM', 'a91234', '2024-02-28', 0, 1, 'KH0009', 'CN01')
INSERT INTO TKNH VALUES ('0983571246', 'NGUYEN THI KIM YEN', 'a2468', '2024-01-15', 10000000, 1, 'KH0010', 'CN02')
INSERT INTO TKNH VALUES ('0985713246', 'NGUYEN VAN B', 'a4682', '2024-02-28', 1000000000, 1, 'KH0011', 'CN02')
INSERT INTO TKNH VALUES ('0987135246', 'TRAN KIM LINH', 'a6824', '2024-01-15', 10000000000, 1, 'KH0012', 'CN01')
INSERT INTO TKNH(SOTK, TENTK, MATKHAU, NGAYTAO, SODU, TRANGTHAI, MAKH, MACN) VALUES ('0981357462', 'NGUYEN QUOC MINH', 'a8246', '2024-01-15', 0, 1, 'KH0013', 'CN02')

-- BANG GD_CHUYENNHAN --
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10001', '0678912345', '0789123456', 100000, '2024-02-28', 'NV001')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10002', '0789123456', '0678912345', 50000, '2024-02-28', 'NV002')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10003', '0946822351', '0982465123', 50000, '2024-02-28', 'NV003')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10004', '0946822351', '0567891234', 50000, '2024-02-28', 'NV004')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10005', '0946822351', '0983571246', 50000, '2024-02-28', 'NV005')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10006', '0985713246', '0982465123', 50000, '2024-02-28', 'NV006')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10007', '0985713246', '0234567891', 50000, '2024-02-28', 'NV007')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10008', '0345678912', '0789123456', 50000, '2024-02-28', 'NV008')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10009', '0345678912', '0983571246', 50000, '2024-02-28', 'NV009')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10010', '0345678912', '0567891234', 50000, '2024-02-28', 'NV010')
INSERT INTO GD_CHUYENNHAN (MAGD, SOTK_GUI, SOTK_NHAN, SOTIEN, NGAYGD, MANV) VALUES ('GD10011', '0123456789', '0234567891', 50000, '2024-02-28', 'NV010')


-- BANG GD_GOIRUT --
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20001', '0123456789', 'GT', 100000, '2024-02-28', 'NV001')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20002', '0123456789', 'RT', 50000, '2024-02-28', 'NV002')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20003', '0983571246', 'GT', 50000, '2024-02-28', 'NV002')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20004', '0983571246', 'GT', 700000, '2024-02-28', 'NV004')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20005', '0567891234', 'RT', 500000, '2024-02-28', 'NV001')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20006', '0678912345', 'GT', 50000, '2024-02-28', 'NV001')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20007', '0567891234', 'RT', 20000, '2024-02-28', 'NV003')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20008', '0678912345', 'GT', 50000, '2024-02-28', 'NV001')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20009', '0946822351', 'RT', 90000, '2024-02-28', 'NV002')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20010', '0924681235', 'GT', 50000, '2024-02-28', 'NV004')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20011', '0946822351', 'GT', 50000, '2024-02-28', 'NV003')
INSERT INTO GD_GOIRUT (MAGD, SOTK, LOAIGD, SOTIEN, NGAYGD, MANV) VALUES ('GD20012', '0345678912', 'GT', 500000, '2024-03-28', 'NV003')


